// Generated by CoffeeScript 1.6.3
(function() {
  var app;

  $(document).foundation();

  app = angular.module('freeperApp', ['ngRoute', 'highcharts-ng', 'freeperControllers', 'facebook-ng']);

  app.run([
    '$rootScope', '$window', 'Facebook', function($rootScope, $window, Facebook2) {
      return $rootScope.$ = $;
    }
  ]);

  app.factory('AccessToken', [
    '$location', function($location) {
      var token, token_expires,
        _this = this;
      token = null;
      token_expires = new Date();
      return {
        get: function(callback) {
          if ((_this.token != null) && _this.token_expires > new Date()) {
            return callback(_this.token);
          } else {
            return $location.path('/auth');
          }
        },
        set: function(token, expires) {
          _this.token = token;
          return _this.token_expires = expires;
        }
      };
    }
  ]);

  app.config([
    '$routeProvider', '$sceDelegateProvider', function($routeProvider, $sceDelegateProvider) {
      $routeProvider.when('/app/', {
        templateUrl: 'static/partials/app.html',
        controller: 'AppCtrl'
      }).when('/sync/', {
        templateUrl: 'static/partials/status.html',
        controller: 'SyncCtrl'
      }).when('/auth/:redirectTo/', {
        templateUrl: 'static/partials/status.html',
        controller: 'AuthCtrl'
      }).when('/reset/', {
        templateUrl: 'static/partials/status.html',
        controller: 'ResetCtrl'
      }).otherwise({
        redirectTo: '/auth/sync/'
      });
      return $sceDelegateProvider.resourceUrlWhitelist(['self', 'https://freepr.s3.amazonaws.com/*']);
    }
  ]);

}).call(this);
